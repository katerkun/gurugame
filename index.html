<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circle of Love - Official Download</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #ff7eb3;
            --color-secondary: #7afcff;
            --color-accent: #ffeb3b;
            --color-text: #4a0e4e;
            --pixel-border: 4px solid #2d1b2e;
        }

        body {
            font-family: 'VT323', monospace;
            background-color: #fff0f5;
            background-image: 
                linear-gradient(45deg, #ff7eb3 25%, transparent 25%, transparent 75%, #ff7eb3 75%, #ff7eb3),
                linear-gradient(45deg, #ff7eb3 25%, transparent 25%, transparent 75%, #ff7eb3 75%, #ff7eb3);
            background-position: 0 0, 20px 20px;
            background-size: 40px 40px;
            background-color: #ffeef5;
            overflow: hidden;
            margin: 0;
            padding: 0;
            color: var(--color-text);
        }

        .handwritten {
            font-family: 'Indie Flower', cursive;
        }

        /* Efectos 3D para el libro */
        .book-container {
            perspective: 2000px;
        }

        .book {
            transform-style: preserve-3d;
            transition: transform 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            width: 340px;
            height: 480px;
            position: relative;
        }

        @media (min-width: 768px) {
            .book {
                width: 700px;
                height: 500px;
            }
        }

        .book-cover, .book-page {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 4px;
            box-shadow: 8px 8px 0px rgba(0,0,0,0.2);
            border: var(--pixel-border);
        }

        /* Portada Frontal - Estilo Grimoire Pop */
        .book-cover.front {
            /* El fondo ahora es manejado por el SVG, dejamos un color base por si acaso */
            background: #d32f2f; 
            transform-origin: left;
            z-index: 20;
            transition: transform 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            justify-content: center;
            /* Cursor pointer para indicar que es clickeable */
            cursor: pointer;
        }

        /* Hover effect para el libro cerrado */
        .book-closed .book-cover.front:hover {
            transform: rotateY(-15deg) scale(1.02);
            box-shadow: 12px 12px 0px rgba(0,0,0,0.3);
        }

        .book-spine {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 40px;
            background: #d63031;
            transform: rotateY(90deg) translateX(-20px);
            transform-origin: left;
            border: var(--pixel-border);
        }

        /* Interior del libro (estilo papel antiguo/RPG) */
        .book-interior {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fffcf0; /* Color pergamino */
            z-index: 10;
            display: flex;
            border-radius: 4px;
            overflow: hidden;
            border: var(--pixel-border);
        }

        /* Decoración mágica giratoria */
        .magic-circle-spin {
            animation: spin 10s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Estados del libro */
        .book-closed .book-cover.front {
            transform: rotateY(0deg);
        }

        .book-open .book-cover.front {
            transform: rotateY(-180deg);
            cursor: default; /* Ya no es clickeable para abrir cuando está abierto */
        }

        /* Botón RPG Retro */
        .rpg-btn {
            background: #3b82f6;
            border: 4px solid #1d4ed8;
            box-shadow: inset -4px -4px 0px rgba(0,0,0,0.3), inset 4px 4px 0px rgba(255,255,255,0.3);
            image-rendering: pixelated;
            transition: all 0.1s;
        }
        .rpg-btn:active {
            transform: translateY(2px);
            box-shadow: inset -2px -2px 0px rgba(0,0,0,0.3), inset 2px 2px 0px rgba(255,255,255,0.3);
        }

        .rpg-input {
            border: 4px solid #4a0e4e;
            background: #fff;
            box-shadow: inset 4px 4px 0px rgba(0,0,0,0.1);
        }
        
        /* Animación "Jumping" de personajes */
        .bounce-char {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .pixel-corners {
            clip-path: polygon(
                0px 10px, 10px 10px, 10px 0px, 
                calc(100% - 10px) 0px, calc(100% - 10px) 10px, 100% 10px, 
                100% calc(100% - 10px), calc(100% - 10px) calc(100% - 10px), calc(100% - 10px) 100%, 
                10px 100%, 10px calc(100% - 10px), 0px calc(100% - 10px)
            );
        }
        
        /* Estilos específicos para los SVGs de personajes */
        .char-svg {
            filter: drop-shadow(4px 4px 0px rgba(45, 27, 46, 0.3));
            transition: transform 0.2s;
        }
        .char-svg:hover {
            transform: scale(1.1) rotate(5deg);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Iconos SVG Estilo Pixel/Doodle
        const DownloadIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="square" strokeLinejoin="miter"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        );

        const MagicSpiral = ({ className }) => (
            <svg className={className} viewBox="0 0 100 100" fill="none" stroke="currentColor" strokeWidth="8" strokeLinecap="round">
                <path d="M50 50 m 0 -5 a 5 5 0 1 1 0 10 a 10 10 0 1 1 0 -20 a 20 20 0 1 1 0 40 a 35 35 0 1 1 0 -70" opacity="0.6"/>
            </svg>
        );

        // --- IMAGEN DE PORTADA PERSONALIZADA ---
        const GrimoireCover = () => (
            <svg className="absolute inset-0 w-full h-full" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
                <defs>
                    <pattern id="magic-pattern" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
                         <circle cx="20" cy="20" r="2" fill="#b71c1c" opacity="0.5"/>
                         <path d="M10 10 L30 30 M30 10 L10 30" stroke="#b71c1c" strokeWidth="1" opacity="0.2"/>
                    </pattern>
                </defs>
                
                {/* Fondo Base */}
                <rect width="100%" height="100%" fill="#e53935" />
                <rect width="100%" height="100%" fill="url(#magic-pattern)" />
                
                {/* Borde Dorado Decorativo */}
                <rect x="5%" y="3%" width="90%" height="94%" rx="10" fill="none" stroke="#FFD700" strokeWidth="4" strokeDasharray="15, 10" />
                <rect x="7%" y="4.5%" width="86%" height="91%" rx="8" fill="none" stroke="#FFD700" strokeWidth="2" />

                {/* Esquinas Mágicas */}
                <g fill="none" stroke="#FFD700" strokeWidth="3">
                    {/* Arriba Izquierda */}
                    <path d="M20 60 L20 20 L60 20" /> 
                    <circle cx="30" cy="30" r="5" fill="#FFD700" stroke="none"/>
                    
                    {/* Arriba Derecha */}
                    <path d="M-20 60 L-20 20 L-60 20" transform="scale(-1, 1) translate(-100%, 0)"/> 
                    
                    {/* Abajo Izquierda */}
                    <path d="M20 -60 L20 -20 L60 -20" transform="scale(1, -1) translate(0, -100%)"/>
                    
                    {/* Abajo Derecha */}
                    <path d="M-20 -60 L-20 -20 L-60 -20" transform="scale(-1, -1) translate(-100%, -100%)"/>
                </g>

                {/* Círculo Mágico Central de Fondo */}
                <g transform="translate(50%, 50%)" style={{ transformBox: 'fill-box', transformOrigin: 'center' }}>
                    <circle cx="0" cy="0" r="30%" fill="none" stroke="#FFD700" strokeWidth="2" opacity="0.3" />
                    <path d="M-50 0 L50 0 M0 -50 L0 50" stroke="#FFD700" strokeWidth="1" opacity="0.3" />
                    <rect x="-35" y="-35" width="70" height="70" transform="rotate(45)" fill="none" stroke="#FFD700" strokeWidth="1" opacity="0.3"/>
                </g>
            </svg>
        );

        // --- PERSONAJES SVG CUSTOMIZADOS ---

        const NikeAvatar = () => (
             <div className="w-24 h-24 rounded-full border-4 border-[#2d1b2e] overflow-hidden bg-white shadow-md relative group">
                <img 
                    src="http://googleusercontent.com/image_generation_content/0" 
                    alt="Nike" 
                    className="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                />
            </div>
        );

        const KukuriAvatar = () => (
            <div className="w-24 h-24 rounded-full border-4 border-[#2d1b2e] overflow-hidden bg-white shadow-md relative group">
                <img 
                    src="http://googleusercontent.com/image_generation_content/1" 
                    alt="Kukuri" 
                    className="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                />
            </div>
        );

        const TreasureChest = () => (
             <svg className="char-svg bounce-char" width="120" height="120" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                {/* Base del cofre */}
                <path d="M20 50 L80 50 L75 80 L25 80 Z" fill="#FBC02D" stroke="#2d1b2e" strokeWidth="4" strokeLinejoin="round"/>
                {/* Tapa del cofre (abierta un poco) */}
                <path d="M15 40 Q50 20 85 40 L80 50 L20 50 Z" fill="#FDD835" stroke="#2d1b2e" strokeWidth="4" strokeLinejoin="round"/>
                {/* Cerradura */}
                <circle cx="50" cy="55" r="6" fill="#2d1b2e"/>
                <circle cx="50" cy="55" r="3" fill="#F44336"/>
                {/* Brillos / Tesoro */}
                <path d="M30 40 L35 30 L40 40 Z" fill="#00E676" />
                <path d="M60 40 L65 25 L70 40 Z" fill="#2979FF" />
                <path d="M45 40 L50 20 L55 40 Z" fill="#FF4081" />
            </svg>
        );

        const App = () => {
            const [stage, setStage] = useState('closed');
            const [password, setPassword] = useState('');
            const [error, setError] = useState(false);
            const SECRET_CODE = "GURU"; 

            const handleOpenBook = () => {
                // Solo abre el libro si está cerrado. Evita re-trigger si ya está abierto.
                if (stage === 'closed') {
                    setStage('opening');
                    setTimeout(() => setStage('scene1'), 1200);
                }
            };

            const handleFirstDownload = () => {
                // Simulación de descarga
                const link = document.createElement('a');
                link.href = '#'; 
                link.setAttribute('download', 'CircleOfLove_Demo.zip');
                // En un entorno real, descomenta la siguiente línea:
                // link.click();
                setTimeout(() => setStage('password'), 1000);
            };

            const handlePasswordSubmit = (e) => {
                e.preventDefault();
                if (password.toUpperCase() === SECRET_CODE) {
                    setError(false);
                    setStage('scene2');
                } else {
                    setError(true);
                    setTimeout(() => setError(false), 2000);
                }
            };

            const handleSecondDownload = () => {
                setTimeout(() => setStage('closing'), 2000);
                setTimeout(() => setStage('closed'), 3500);
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    
                    {/* Contenedor Principal */}
                    <div className={`book-container relative flex justify-center items-center`}>
                        
                        <div className={`book ${stage === 'closed' ? 'book-closed' : 'book-open'} relative transition-all duration-1000 ${stage !== 'closed' && stage !== 'opening' && stage !== 'closing' ? 'translate-x-0' : ''}`}>
                            
                            {/* INTERIOR DEL GRIMOIRE */}
                            <div className="book-interior flex flex-col md:flex-row">
                                
                                {/* PÁGINA IZQUIERDA: Personajes y Arte */}
                                <div className="w-full md:w-1/2 p-4 flex flex-col items-center justify-center border-b-4 md:border-b-0 md:border-r-4 border-[#2d1b2e] relative bg-[#fffcf0]">
                                    {/* Marcos decorativos en esquinas */}
                                    <div className="absolute top-2 left-2 text-[#ff7eb3]">╔</div>
                                    <div className="absolute top-2 right-2 text-[#ff7eb3]">╗</div>
                                    <div className="absolute bottom-2 left-2 text-[#ff7eb3]">╚</div>
                                    <div className="absolute bottom-2 right-2 text-[#ff7eb3]">╝</div>

                                    {(stage === 'scene1' || stage === 'password') && (
                                        <div className="text-center z-10 animate-[fadeIn_0.5s_ease-out]">
                                            <div className="bg-[#ffeb3b] border-4 border-[#2d1b2e] p-2 mb-4 rotate-2 inline-block shadow-[4px_4px_0px_rgba(0,0,0,0.2)]">
                                                <span className="text-2xl font-bold tracking-widest text-[#d63031]">QUEST START!</span>
                                            </div>
                                            
                                            <div className="flex justify-center gap-2 mb-4 mt-2 items-end">
                                                {/* NIKE - Avatar estilo Doodle */}
                                                <div className="flex flex-col items-center bounce-char">
                                                    <NikeAvatar />
                                                    <div className="bg-[#2d1b2e] text-white text-xs px-2 py-0.5 mt-1 font-bold transform -rotate-2">NIKE</div>
                                                </div>
                                                
                                                {/* KUKURI - Avatar estilo Doodle */}
                                                <div className="flex flex-col items-center bounce-char" style={{animationDelay: '0.2s'}}>
                                                    <KukuriAvatar />
                                                    <div className="bg-[#2d1b2e] text-white text-xs px-2 py-0.5 mt-1 font-bold transform rotate-2">KUKURI</div>
                                                </div>
                                            </div>
                                            
                                            <div className="handwritten text-xl text-gray-600 -rotate-2 mt-2">
                                                "¡Vamos a buscar el Guru Guru!"
                                            </div>
                                        </div>
                                    )}

                                    {stage === 'scene2' && (
                                        <div className="text-center z-10 animate-[fadeIn_0.5s_ease-out]">
                                            <div className="relative">
                                                <MagicSpiral className="w-48 h-48 mx-auto text-[#ff7eb3] magic-circle-spin absolute top-0 left-0 right-0 bottom-0 m-auto opacity-50" />
                                                <TreasureChest />
                                            </div>
                                            <h3 className="text-3xl font-bold text-[#d63031] drop-shadow-md mt-4">LEVEL UP!</h3>
                                            <p className="handwritten text-lg mt-2">¡Has desbloqueado el tesoro!</p>
                                        </div>
                                    )}
                                </div>

                                {/* PÁGINA DERECHA: Interacción */}
                                <div className="w-full md:w-1/2 bg-[#fffcf0] p-6 flex flex-col items-center justify-center relative">
                                    {/* Lineas de libreta */}
                                    <div className="absolute inset-0 opacity-10" style={{backgroundImage: 'linear-gradient(#4a0e4e 1px, transparent 1px)', backgroundSize: '100% 24px', marginTop: '24px'}}></div>

                                    {stage === 'scene1' && (
                                        <div className="text-center w-full z-10">
                                            <h2 className="text-3xl mb-4 text-[#4a0e4e]">Capítulo 1</h2>
                                            <div className="bg-white border-4 border-[#2d1b2e] p-4 mb-6 text-left shadow-[4px_4px_0px_#ccc]">
                                                <p className="text-lg leading-tight">¿Estás listo para comenzar la aventura?</p>
                                            </div>
                                            <button 
                                                onClick={handleFirstDownload}
                                                className="rpg-btn text-white text-xl px-6 py-3 w-full font-bold flex items-center justify-center gap-2"
                                            >
                                                <DownloadIcon /> DESCARGAR
                                            </button>
                                        </div>
                                    )}

                                    {stage === 'password' && (
                                        <div className="text-center w-full z-10">
                                            <h2 className="text-2xl mb-2">SELLO MÁGICO</h2>
                                            <p className="handwritten text-lg mb-4 text-[#d63031]">¡Di la palabra secreta!</p>
                                            
                                            <form onSubmit={handlePasswordSubmit} className="w-full">
                                                <input 
                                                    type="text" 
                                                    value={password}
                                                    onChange={(e) => setPassword(e.target.value)}
                                                    placeholder="A B C..."
                                                    className="rpg-input w-full px-4 py-3 text-center text-2xl mb-2 font-bold uppercase text-[#4a0e4e] focus:outline-none focus:bg-yellow-50"
                                                />
                                                {error ? (
                                                    <p className="text-red-500 text-lg animate-pulse mb-2">¡FALLASTE!</p>
                                                ) : (
                                                    <p className="text-gray-400 text-sm mb-2 opacity-0">.</p>
                                                )}
                                                <button 
                                                    type="submit"
                                                    className="rpg-btn bg-[#9c27b0] border-[#7b1fa2] text-white w-full py-2 text-xl"
                                                >
                                                    INVOCAR
                                                </button>
                                            </form>
                                            <div className="mt-4 text-sm bg-yellow-100 p-2 border-2 border-dashed border-yellow-400 inline-block rotate-1">
                                                <span className="handwritten font-bold">Pista:</span> Nombre de la tribu...
                                            </div>
                                        </div>
                                    )}

                                    {stage === 'scene2' && (
                                        <div className="text-center w-full z-10">
                                            <h2 className="text-3xl mb-4 text-[#e91e63]">¡FINAL!</h2>
                                            <div className="bg-pink-100 border-4 border-[#e91e63] p-3 mb-6 shadow-[4px_4px_0px_#f8bbd0]">
                                                <p className="font-bold text-[#880e4f]">♫ BGM: Circle of Love</p>
                                                <p className="handwritten text-sm">Voces: Nike & Kukuri</p>
                                            </div>
                                            <button 
                                                onClick={handleSecondDownload}
                                                className="rpg-btn bg-[#ff4081] border-[#c2185b] text-white w-full py-4 text-xl flex items-center justify-center gap-2 animate-pulse"
                                            >
                                                <DownloadIcon /> OBTENER TESORO
                                            </button>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* PORTADA EXTERIOR (Estilo Grimoire) */}
                            {/* Ahora tiene onClick para abrirse solo al tocarlo */}
                            <div 
                                className={`book-cover front ${stage !== 'closed' ? 'open-book' : ''}`} 
                                onClick={handleOpenBook}
                                style={{
                                    transform: (stage === 'closed' || stage === 'closing') ? 'rotateY(0deg)' : 'rotateY(-180deg)'
                                }}
                            >
                                {/* Lomo del libro visible al girar ligeramente */}
                                <div className="absolute left-0 top-0 bottom-0 w-8 bg-[#b71c1c] border-r-4 border-[#2d1b2e] z-0"></div>
                                
                                {/* Imagen de Portada Generada por SVG */}
                                <GrimoireCover />

                                <div className="flex flex-col items-center justify-center w-full h-full p-8 text-center text-[#2d1b2e] z-10 pointer-events-none">
                                    
                                    {/* Círculo Mágico Decorativo en la portada (superpuesto al SVG base) */}
                                    <div className="relative w-48 h-48 mb-6 flex items-center justify-center">
                                        <div className="absolute inset-2 border-[2px] border-[#fff] rounded-full opacity-80 border-dashed animate-[spin_20s_linear_infinite]"></div>
                                        <MagicSpiral className="text-white w-32 h-32 animate-[spin_8s_linear_infinite]" />
                                    </div>

                                    <h1 className="text-5xl font-bold text-white drop-shadow-[4px_4px_0px_#2d1b2e] leading-none mb-2 transform -rotate-2">
                                        CIRCLE<br/>OF<br/>LOVE
                                    </h1>
                                    <div className="bg-white px-2 py-1 mt-4 border-2 border-[#2d1b2e] shadow-[4px_4px_0px_rgba(0,0,0,0.2)]">
                                        <p className="text-sm font-bold tracking-widest">MAGIC THREE VOICES</p>
                                    </div>
                                    
                                    {stage === 'closed' && (
                                        <div className="absolute bottom-12 text-white font-bold animate-pulse text-lg bg-[#00000033] px-3 rounded">
                                            Tap to Open
                                        </div>
                                    )}
                                </div>
                            </div>

                        </div>
                    </div>
                    
                    <footer className="fixed bottom-2 text-[#4a0e4e] text-lg w-full text-center handwritten">
                         © 2025 Guru Guru Project 
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
